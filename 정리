

	-  엑셀업로드 
	    
		- 참고 화면
			점포운영>상품관리>BSD관리>존/로케이션 상품관리  => 상품목록 => 일괄업로드  (MFC::NSBSDC010_P02.xfdl)
				=>> 화면단에서는 벨리데이션 체크 안함, 서비스단에서 임시 엑셀업로드 테이블에 저장 후  재고처리, 실행결과를 리턴해준다.
		
			점포운영>재고관리>재고조사>재고조사업무 => 점포 00037   (  CO_CD : 1002 / ORG_CD(점포코드) : A1600037 )  (SMSI::NSSMSI010_P02.xfdl)
				=>> 화면단에서 벨리데이션 체크 에러가 있으면 그냥 단건 알럿처리.
 
		- 업로드시 예상되는 최대 건수?  => 1000건
		- 사유구분업로드시 코드로 체크할것인지 / 코드명으로 할것인지 구분필요.  => 코드로 등록
		
		- VALIDATION 체크 항목
			1. PLU_CD
				: 필수체크
				: 등록가능한 상품인지 체크
			     (
				   - 점포상품마스터 기준으로 공통상품마스터 OR 사입마스터에 값이 존재하는지 체크
				   - TABLE(CAST(US_STRADM.NFN_TNB_STRGDS_MST(TO_CHAR(SYSDATE , 'YYYYMMDD'), EX.CO_CD , EX.ORG_CD,'', EX.PLU_CD) AS US_STRADM.TAB_TNB_STRGDS_MST)) CM /*TNB_점포상품마스터(US_STRADM.TNB_STRGDS_MST) */
					  AND CM.DEL_YN          = '0'            /* 삭제여부  */
					  AND CM.RTN_ENBL_YN     = '1'		      /* 반품가능여부 */
					  AND CM.BUY_GDS_YN      = '0'            /* 사입상품여부<C188> */
					  AND CM.FNB_GDS_TP      = '00'           /* 상품만(공병,공박스 제외) */
				  )  
				: (엑셀에)중복으로 등록한 상품인지 여부(sum해서 넣어줄수는 있지만 이게 사용자가 상품코드를 잘못 입력한건지 알 수 없기 때문에 오류처리 - 오류처리 안하면 휴먼에러를 정상처리 할 수 있음.)
			
			2. 수량
				: 필수체크
			    : 양의 정수인지 체크
				: 입력 수량 이(가) 반품가능수량 보다 큽니다. (RTN_ENBL_QTY < REQ_QTY)
				: 입력 수량이 현재고보다 큽니다 (NSTCK_QTY < REQ_QTY)
			
			3. 사유구분
				: [D305-점포반품사유구분]에 등록된 코드인지 체크.
				
		- 저장시 현재 재고조사 여부 확인 , 재고조사 중이면 저장할 수 없도록.
		
		- 기존에 데이터가 있으면 업데이트. 없으면 insert => 저장시 merge문 사용
		
		- 수량이 0인경우 삭제 처리(DEL_YN을 1로 자동 insert or update)
			 
	
	- 상단 점포 팝업 (COM_CodePopup.xfdl => NSTBTB010_T08.xfdl)
	    - 세팅은 코드값 : application.gds_user.getColumn(0, "BIZLOC_CD") 로 초기 세팅및 조회 검색 결과를 넣어준다.
		- 공통서치 팝업 : COM_CodePopup.xfdl
		- 초기 세팅은 : this.setPopupType();
		- 코드넣고 엔터시 자동조회 값이 있으면 자동으로 데이터 가져오고 값이 없으면 팝업을 띄우는 형태. <= this.fn_CallPopup 함수 strGbn 구분이 E인 경우.
		- 코드 결과값 세팅은 : 콜백함수 this.fn_setCommPopupReturn(또는 case "selectListParam") 에서 조회 결과에 컬럼값과 this.ds_cond 에 컬럼값이 같은 데이터가 있으면 자동으로 넣어준다.

	- 요청일자
		=> 오늘 날짜로 세팅 됨.
		    var dtFrom = new NXDate();
		   this.div_cond.cal_rtnReqDt.set_value(dtFrom.toFormatString()) ;

	- 상단 라디오버튼

		=> COM_GRP_CD : S013 (반품구분)
			  인거같은데 실제 화면단에서는 하드코딩해서 쓰고있고 DB에 있는 코드와 값이 다르다.
			   <<= 아닌듯 공통코드 아니고 그냥 별 의미없이 박아 놓은듯...
		   
		=> 현재 총 7개 
			// 시즌행사  "0" 
			// 초도    "1" 
			// 리콜    "2" 
			// 폐점    "3" 
			// 오픈행사  "4" 
			// 공병반품  "5" 
			// 한도반품  "6" 
		   
		=> 점포 DB(ns/tb/tb010/selectOrgInfo.do) 값에 따라 라디오버튼 값이 안나올수 있다.
			  - 초도반품가능여부   
			  - 폐점반품가능여부 (SM이면서 폐점일자 전후 1개월동안 가능)
			  =>> 위 두개는 값에 따라 보이고 안보이고 한다.		  		  
		   
		=> application.uarguments['tabframe'].form.pv_param2(메인에서 todo 찍고 들어온 경우 인듯??)
		  의 값이 있다면 그 값에 따라 라디오버튼 값이 다르게 기본으로 선택 된다.
		  
		  
	- 하단탭 (시증/행사 기준 - NSTBTB010_T01)
	  항목별로 초기 검색 및 체크로직 다름, 저장과 전표처리는 거의 같아보임.
	  		

		=> // 점포 반품 일자 조회(반품한도도 동시에 체크)
			 this.fn_getRtnClosDd() ;  //  ns.TbTb010.selectRtnClosDd
				반품마감 유무 확인
					var iRtnAblAmt = // 반품가용금액   <<== BSD에서는 체크 안함.
					var sRtnOrgCd  = // 반품점포코드
					var sRtnAblYn  = // 반품가능여부
						=> 이 값에 따라 엑셀업로드 / 행추가,삭제 버튼을 활성화/비활성화 한다.
				
		=> // 점포 반품요청 조회
			this.fn_search() ;  // /ns/tb/tb010/selectRtnList.do
			
						  select C1.*
						          .....
						  FROM US_STRADM.TNB_HQMGDS_MST C1     /* TNB_공통상품마스터 */
						 INNER JOIN TABLE(CAST(US_STRADM.NFN_TNB_STRGDS_MST(TO_CHAR(SYSDATE , 'YYYYMMDD'), C1.CO_CD , 'A1605949' , C1.PLU_CD) AS US_STRADM.TAB_TNB_STRGDS_MST)) CM  /* TNB_점포상품마스터 */
							ON 1 = 1
					★★★★   AND C1.RTN_TP        IN ('1','5')  /* 시즌/행사  => S013 */
						       .....
		 
		=> 반품 상품 리스트 [] 조회 버튼
		   현재 그리드에 해당하는 코드 or 상품명에 로우 위치로 이동시켜준다. (실제 DB 조회가 아님)
		
		=> 저장
			validation
			   : 반품가능수량(RTN_ENBL_QTY) 보다 요청 수량이 큰지 체크
			   : 요청일자가 현재일자와 다르면 체크.
			   : 0건인건 삭제 처리
			   
			/ns/tb/tb010/saveRtnItem.do  <<= 모든 탭이 여기호출 => 서비스단에서 공통으로 처리 (항목별로 값을 변경해주는 로직 약간 있음.)
			MERGE /* ns.TbTb010.insertRtnItem */ 
            INTO US_STRADM.TNM_STRRTN_MGR CM  /* TNM_점포반품요청관리 */
		
		=> 전표처리
			/ns/tb/tb010/saveSlip.do     <<= 모든 탭이 여기호출 => 서비스단에서 공통으로 처리 (항목별로 다른점 없는 듯?)
			=> 전표처리  US_STRADM.NPR_ST_SLIP_STRRTN  프러시저 호출
			=> 여신등록
				US_STRADM.NPR_HQ_LOANHIS_CREATE
			
		=>> ★★★★★
		     상품코드(PLU_CD) 관련 마스터는 아래 3개가 있는거 같고. 중요한건 TNB_STRGDS_MST에 PLU_CD가 실제 여기서 써야하는 PLU_CD다. 
		     TNB_HQMGDS_MST, TNB_BUYGDS_MST에 PLU_CD와 점포상품 마스터를 JOIN하기 위해서는 CONN_CD(연결코드)로 이어줘야한다.
			★★★★★
			US_STRADM.TNB_STRGDS_MST A /* ★TNB_점포상품마스터★ */
				US_STRADM.TNB_HQMGDS_MST B /* TNB_공통상품마스터 */
				US_STRADM.TNB_BUYGDS_MST B /* TNB_사입상품마스터 */
		
                    LEFT OUTER JOIN
                             (
                              SELECT A.ORG_CD, A.CO_CD, A.PLU_CD, B.GDS_NM
                                FROM US_STRADM.TNB_STRGDS_MST A /* TNB_점포상품마스터 */
                                INNER JOIN
                                     US_STRADM.TNB_HQMGDS_MST B /* TNB_공통상품마스터 */
                                   ON A.CO_CD = B.CO_CD
                                  AND A.CONN_CD = B.PLU_CD
                             ) M2
                          ON M1.BIZLOC_ORG_CD = M2.ORG_CD       /* 조직코드  */
                         AND M1.PLU_CD   = M2.PLU_CD            /* PLU코드 */
                         AND M1.CO_CD    = M2.CO_CD             /* 회사코드 */
                    LEFT OUTER JOIN
                           (
                              SELECT A.ORG_CD, A.CO_CD, A.PLU_CD, B.GDS_NM
                                FROM US_STRADM.TNB_STRGDS_MST A /* TNB_점포상품마스터 */
                                INNER JOIN
                                     US_STRADM.TNB_BUYGDS_MST B /* TNB_사입상품마스터 */
                                   ON A.CO_CD = B.CO_CD
                                  AND A.ORG_CD = B.ORG_CD
                                  AND A.CONN_CD = B.PLU_CD
                           ) SS
                        ON SS.ORG_CD       = M1.BIZLOC_ORG_CD      /* [PK]사업장조직코드  */
                       AND SS.PLU_CD       = M1.PLU_CD            /* [PK]PLU코드  */
                       AND SS.CO_CD        = M1.CO_CD              /* 회사코드 */
			★★★★★		   
			  점포현금매입(사입)상품과 공통상품마스터를 걸기위해서는 아래와 같이 REPR_PLU_CD를 사용한다.
			★★★★★
				    US_STRADM.TNB_BUYGDS_MST SS       /* ST_점포현금매입상품 */
              INNER JOIN
                    US_STRADM.TNB_HQMGDS_MST C1       /* TNB_공통상품마스터 */
                 ON C1.PLU_CD        = SS.REPR_PLU_CD /* [PK]품목코드  */
                AND C1.CO_CD         = SS.CO_CD       /* 회사코드 */
